{"version":3,"file":"json-patch.min.js","sources":["../src/json-patch.js"],"names":["jsonpatch","apply","tree","patches","patch","result","p","plen","length","keys","path","split","obj","t","len","_isArray","index","parseInt","arrOps","op","call","key","indexOf","replace","objOps","add","this","value","remove","move","temp","from","copy","test","JSON","stringify","_get","arr","i","splice","Array","isArray","push","exports"],"mappings":";;;;;AAKA,GAAIA,YACJ,SAAWA,GAsEP,QAASC,GAAMC,EAAMC,GAEjB,IADA,GAAkDC,GAA9CC,GAAS,EAAOC,EAAI,EAAGC,EAAOJ,EAAQK,OAC/BD,EAAJD,GAAU,CACbF,EAAQD,EAAQG,EAOhB,KAJA,GAAIG,GAAOL,EAAMM,KAAKC,MAAM,KACxBC,EAAMV,EACNW,EAAI,EACJC,EAAML,EAAKD,SAEX,GAAIO,EAASH,GAAM,CACf,GAAII,GAAQC,SAASR,EAAKI,GAAI,GAE9B,IADAA,IACIA,GAAKC,EAAK,CACVT,EAASa,EAAOd,EAAMe,IAAIC,KAAKhB,EAAOQ,EAAKI,EAAOd,EAClD,OAEJU,EAAMA,EAAII,OACP,CACH,GAAIK,GAAMZ,EAAKI,EAIf,IAHwB,IAApBQ,EAAIC,QAAQ,OACZD,EAAMA,EAAIE,QAAQ,MAAO,KAAKA,QAAQ,MAAO,MACjDV,IACIA,GAAKC,EAAK,CACVT,EAASmB,EAAOpB,EAAMe,IAAIC,KAAKhB,EAAOQ,EAAKS,EAAKnB,EAChD,OAEJU,EAAMA,EAAIS,GAGlBf,IAEJ,MAAOD,GAtGX,GA2DIU,GA3DAS,GACAC,IAAK,SAAUb,EAAKS,GAEhB,MADAT,GAAIS,GAAOK,KAAKC,OACT,GAEXC,OAAQ,SAAUhB,EAAKS,GAEnB,aADOT,GAAIS,IACJ,GAEXE,QAAS,SAAUX,EAAKS,GAEpB,MADAT,GAAIS,GAAOK,KAAKC,OACT,GAEXE,KAAM,SAAUjB,EAAKS,EAAKnB,GACtB,GAAI4B,IAASX,GAAI,OAAQT,KAAMgB,KAAKK,KAQpC,OAPA9B,GAAMC,GAAO4B,IACb7B,EAAMC,IACAiB,GAAI,SAAUT,KAAMgB,KAAKK,QAE/B9B,EAAMC,IACAiB,GAAI,MAAOT,KAAMgB,KAAKhB,KAAMiB,MAAOG,EAAKH,UAEvC,GAEXK,KAAM,SAAUpB,EAAKS,EAAKnB,GACtB,GAAI4B,IAASX,GAAI,OAAQT,KAAMgB,KAAKK,KAKpC,OAJA9B,GAAMC,GAAO4B,IACb7B,EAAMC,IACAiB,GAAI,MAAOT,KAAMgB,KAAKhB,KAAMiB,MAAOG,EAAKH,UAEvC,GAEXM,KAAM,SAAUrB,EAAKS,GACjB,MAAQa,MAAKC,UAAUvB,EAAIS,MAAUa,KAAKC,UAAUT,KAAKC,QAE7DS,KAAM,SAAUxB,EAAKS,GACjBK,KAAKC,MAAQf,EAAIS,KAIrBH,GACAO,IAAK,SAAUY,EAAKC,GAEhB,MADAD,GAAIE,OAAOD,EAAG,EAAGZ,KAAKC,QACf,GAEXC,OAAQ,SAAUS,EAAKC,GAEnB,MADAD,GAAIE,OAAOD,EAAG,IACP,GAEXf,QAAS,SAAUc,EAAKC,GAEpB,MADAD,GAAIC,GAAKZ,KAAKC,OACP,GAEXE,KAAML,EAAOK,KACbG,KAAMR,EAAOQ,KACbC,KAAMT,EAAOS,KACbG,KAAMZ,EAAOY,KAKbrB,GADAyB,MAAMC,QACKD,MAAMC,QAEN,SAAU7B,GACjB,MAAOA,GAAI8B,MAA8B,gBAAf9B,GAAIJ,QAwCtCR,EAAUC,MAAQA,GACnBD,YAAcA,eAEM,mBAAZ2C,WACPA,QAAQ1C,MAAQD,UAAUC","sourcesContent":["/*!\r\n* json-patch-duplex.js 0.3.7\r\n* (c) 2013 Joachim Wester\r\n* MIT license\r\n*/\r\nvar jsonpatch;\r\n(function (jsonpatch) {\r\n    var objOps = {\r\n        add: function (obj, key) {\r\n            obj[key] = this.value;\r\n            return true;\r\n        },\r\n        remove: function (obj, key) {\r\n            delete obj[key];\r\n            return true;\r\n        },\r\n        replace: function (obj, key) {\r\n            obj[key] = this.value;\r\n            return true;\r\n        },\r\n        move: function (obj, key, tree) {\r\n            var temp = { op: \"_get\", path: this.from };\r\n            apply(tree, [temp]);\r\n            apply(tree, [\r\n                { op: \"remove\", path: this.from }\r\n            ]);\r\n            apply(tree, [\r\n                { op: \"add\", path: this.path, value: temp.value }\r\n            ]);\r\n            return true;\r\n        },\r\n        copy: function (obj, key, tree) {\r\n            var temp = { op: \"_get\", path: this.from };\r\n            apply(tree, [temp]);\r\n            apply(tree, [\r\n                { op: \"add\", path: this.path, value: temp.value }\r\n            ]);\r\n            return true;\r\n        },\r\n        test: function (obj, key) {\r\n            return (JSON.stringify(obj[key]) === JSON.stringify(this.value));\r\n        },\r\n        _get: function (obj, key) {\r\n            this.value = obj[key];\r\n        }\r\n    };\r\n\r\n    var arrOps = {\r\n        add: function (arr, i) {\r\n            arr.splice(i, 0, this.value);\r\n            return true;\r\n        },\r\n        remove: function (arr, i) {\r\n            arr.splice(i, 1);\r\n            return true;\r\n        },\r\n        replace: function (arr, i) {\r\n            arr[i] = this.value;\r\n            return true;\r\n        },\r\n        move: objOps.move,\r\n        copy: objOps.copy,\r\n        test: objOps.test,\r\n        _get: objOps._get\r\n    };\r\n\r\n    var _isArray;\r\n    if (Array.isArray) {\r\n        _isArray = Array.isArray;\r\n    } else {\r\n        _isArray = function (obj) {\r\n            return obj.push && typeof obj.length === 'number';\r\n        };\r\n    }\r\n\r\n    /// Apply a json-patch operation on an object tree\r\n    function apply(tree, patches) {\r\n        var result = false, p = 0, plen = patches.length, patch;\r\n        while (p < plen) {\r\n            patch = patches[p];\r\n\r\n            // Find the object\r\n            var keys = patch.path.split('/');\r\n            var obj = tree;\r\n            var t = 1;\r\n            var len = keys.length;\r\n            while (true) {\r\n                if (_isArray(obj)) {\r\n                    var index = parseInt(keys[t], 10);\r\n                    t++;\r\n                    if (t >= len) {\r\n                        result = arrOps[patch.op].call(patch, obj, index, tree); // Apply patch\r\n                        break;\r\n                    }\r\n                    obj = obj[index];\r\n                } else {\r\n                    var key = keys[t];\r\n                    if (key.indexOf('~') != -1)\r\n                        key = key.replace(/~1/g, '/').replace(/~0/g, '~'); // escape chars\r\n                    t++;\r\n                    if (t >= len) {\r\n                        result = objOps[patch.op].call(patch, obj, key, tree); // Apply patch\r\n                        break;\r\n                    }\r\n                    obj = obj[key];\r\n                }\r\n            }\r\n            p++;\r\n        }\r\n        return result;\r\n    }\r\n    jsonpatch.apply = apply;\r\n})(jsonpatch || (jsonpatch = {}));\r\n\r\nif (typeof exports !== \"undefined\") {\r\n    exports.apply = jsonpatch.apply;\r\n}\r\n"]}